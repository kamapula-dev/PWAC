{
  "version": 3,
  "sources": ["../src/index.ts"],
  "sourcesContent": ["const BUCKET_URL = 'https://pwac-media.s3.eu-north-1.amazonaws.com';\nconst DOMAIN_MAPPING_API_URL = 'https://pwac.world/domain-mapping';\n\naddEventListener('fetch', (event) => {\n  // @ts-ignore\n  event.respondWith(handleRequest(event.request));\n});\n\nasync function handleRequest(request: Request): Promise<Response> {\n  try {\n    const url = new URL(request.url);\n    const domainName = url.hostname;\n\n    const mappingResponse = await fetch(\n      `${DOMAIN_MAPPING_API_URL}/${domainName}`,\n    );\n    if (!mappingResponse.ok) {\n      return new Response('Domain mapping not found', { status: 404 });\n    }\n\n    const { pwaId } = await mappingResponse.json();\n    if (!pwaId) {\n      return new Response('PWA ID not found for the domain', { status: 404 });\n    }\n\n    const fileUrl = `${BUCKET_URL}/${pwaId}/index.html`;\n    const fileResponse = await fetch(fileUrl);\n    if (!fileResponse.ok) {\n      return new Response('File not found', { status: 404 });\n    }\n\n    return new Response(fileResponse.body, {\n      headers: {\n        'Content-Type': 'text/html',\n        'Cache-Control': 'public, max-age=3600',\n      },\n      status: fileResponse.status,\n    });\n  } catch (error) {\n    console.error('Error processing request:', error);\n    return new Response('Internal server error', { status: 500 });\n  }\n}\n"],
  "mappings": ";;AAAA,MAAM,aAAa;AACnB,MAAM,yBAAyB;AAE/B,mBAAiB,SAAS,CAAC,UAAU;AAEnC,UAAM,YAAY,cAAc,MAAM,OAAO,CAAC;AAAA,EAChD,CAAC;AAED,iBAAe,cAAc,SAAqC;AAChE,QAAI;AACF,YAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,YAAM,aAAa,IAAI;AAEvB,YAAM,kBAAkB,MAAM;AAAA,QAC5B,GAAG,0BAA0B;AAAA,MAC/B;AACA,UAAI,CAAC,gBAAgB,IAAI;AACvB,eAAO,IAAI,SAAS,4BAA4B,EAAE,QAAQ,IAAI,CAAC;AAAA,MACjE;AAEA,YAAM,EAAE,MAAM,IAAI,MAAM,gBAAgB,KAAK;AAC7C,UAAI,CAAC,OAAO;AACV,eAAO,IAAI,SAAS,mCAAmC,EAAE,QAAQ,IAAI,CAAC;AAAA,MACxE;AAEA,YAAM,UAAU,GAAG,cAAc;AACjC,YAAM,eAAe,MAAM,MAAM,OAAO;AACxC,UAAI,CAAC,aAAa,IAAI;AACpB,eAAO,IAAI,SAAS,kBAAkB,EAAE,QAAQ,IAAI,CAAC;AAAA,MACvD;AAEA,aAAO,IAAI,SAAS,aAAa,MAAM;AAAA,QACrC,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,QACnB;AAAA,QACA,QAAQ,aAAa;AAAA,MACvB,CAAC;AAAA,IACH,SAAS,OAAP;AACA,cAAQ,MAAM,6BAA6B,KAAK;AAChD,aAAO,IAAI,SAAS,yBAAyB,EAAE,QAAQ,IAAI,CAAC;AAAA,IAC9D;AAAA,EACF;",
  "names": []
}
